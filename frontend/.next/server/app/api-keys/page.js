(()=>{var e={};e.id=965,e.ids=[965],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},17297:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>l.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>o,routeModule:()=>m,tree:()=>c}),s(89887),s(29351),s(35866);var a=s(23191),r=s(88716),n=s(37922),l=s.n(n),i=s(95231),d={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>i[e]);s.d(t,d);let c=["",{children:["api-keys",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,89887)),"/app/frontend/app/api-keys/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,29351)),"/app/frontend/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"]}],o=["/app/frontend/app/api-keys/page.tsx"],x="/api-keys/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/api-keys/page",pathname:"/api-keys",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},43372:(e,t,s)=>{Promise.resolve().then(s.bind(s,11058))},11058:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var a=s(10326),r=s(90434),n=s(17577),l=s(19395),i=s(6824);function d(...e){return e.filter(Boolean).join(" ")}function c(){let{token:e}=(0,l.a)(),t=!!e,[s,c]=(0,n.useState)(!0),[o,x]=(0,n.useState)(!0),[u,m]=(0,n.useState)([]),[p,h]=(0,n.useState)([]),[b,g]=(0,n.useState)(null),[j,y]=(0,n.useState)(!1),[f,v]=(0,n.useState)(!1),[N,k]=(0,n.useState)(""),[w,P]=(0,n.useState)(""),[C,_]=(0,n.useState)(["ingest"]),[S,A]=(0,n.useState)(null),I=(0,n.useMemo)(()=>[{id:"ingest",label:"Ingest telemetry"},{id:"read",label:"Read dashboards"},{id:"admin",label:"Admin operations"}],[]);async function K(){if(e){x(!0);try{let t=await (0,i.SC)("/projects/",{method:"GET"},{token:e});m(t||[]),!w&&t?.length&&P(t[0].id)}catch(e){g(e?.message||"Failed to load projects")}finally{x(!1)}}}async function q(){if(e){c(!0),g(null);try{let t=await (0,i.SC)("/projects/api-keys",{method:"GET"},{token:e});h(t||[])}catch(e){g(e?.message||"Failed to load API keys")}finally{c(!1)}}}let T=(0,n.useMemo)(()=>[...p].sort((e,t)=>{let s=e.created_at?Date.parse(e.created_at):0;return(t.created_at?Date.parse(t.created_at):0)-s}),[p]);async function G(){if(!e)return;g(null);let t=N.trim();if(!t){g("Please enter an API key name.");return}if(!w){g("Please select a project.");return}if(!C.length){g("Select at least one scope.");return}v(!0);try{let s=await (0,i.SC)("/projects/api-keys",{method:"POST",body:JSON.stringify({name:t,scopes:C,project_id:w})},{token:e});h(e=>[s,...e]),y(!1),k(""),_(["ingest"]),s?.raw_key?A(s.raw_key):g("API key created, but raw key was not returned (check backend response).")}catch(e){g(e?.message||"Failed to create API key")}finally{v(!1)}}async function L(t){if(e){g(null);try{let s=await (0,i.SC)(`/projects/api-keys/${t}/revoke`,{method:"POST"},{token:e});h(e=>e.map(e=>e.id===t?{...e,...s}:e))}catch(e){g(e?.message||"Failed to revoke API key")}}}async function D(e){try{await navigator.clipboard.writeText(e)}catch{}}return t?(0,a.jsxs)("div",{className:"px-6 py-8",children:[(0,a.jsxs)("div",{className:"mx-auto max-w-6xl",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-end sm:justify-between",children:[(0,a.jsxs)("div",{children:[a.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"API Keys"}),a.jsx("p",{className:"mt-1 text-sm text-neutral-500",children:"Create scoped keys for SDK/CLI ingestion. Raw keys are shown once."})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>{g(null),y(!0)},className:"inline-flex items-center rounded-xl bg-black px-4 py-2 text-sm font-medium text-white hover:opacity-90 disabled:opacity-50",disabled:o,children:"+ New API Key"}),a.jsx("button",{onClick:()=>{K(),q()},className:"inline-flex items-center rounded-xl border border-neutral-200 bg-white px-4 py-2 text-sm font-medium text-neutral-900 hover:bg-neutral-50",children:"Refresh"})]})]}),b&&a.jsx("div",{className:"mt-5 rounded-2xl border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:b}),a.jsx("div",{className:"mt-6 grid grid-cols-1 gap-4",children:(0,a.jsxs)("div",{className:"rounded-2xl border border-neutral-200 bg-white p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"text-sm font-medium text-neutral-900",children:["Keys (",T.length,")"]}),a.jsx("div",{className:"text-xs text-neutral-500",children:s?"Loading...":"Up to date"})]}),(0,a.jsxs)("div",{className:"mt-4 overflow-hidden rounded-xl border border-neutral-200",children:[(0,a.jsxs)("div",{className:"grid grid-cols-12 bg-neutral-50 px-3 py-2 text-xs font-medium text-neutral-600",children:[a.jsx("div",{className:"col-span-4",children:"Name"}),a.jsx("div",{className:"col-span-3",children:"Key Prefix"}),a.jsx("div",{className:"col-span-2",children:"Status"}),a.jsx("div",{className:"col-span-2",children:"Created"}),a.jsx("div",{className:"col-span-1 text-right",children:"Action"})]}),s?a.jsx("div",{className:"px-3 py-6 text-sm text-neutral-500",children:"Loading API keys..."}):0===T.length?(0,a.jsxs)("div",{className:"px-3 py-6 text-sm text-neutral-500",children:["No API keys yet. Click ",a.jsx("span",{className:"font-medium",children:"New API Key"}),"."]}):a.jsx("div",{className:"divide-y divide-neutral-200",children:T.map(e=>{let t=!1!==e.is_active&&!e.revoked_at;return(0,a.jsxs)("div",{className:"grid grid-cols-12 items-center px-3 py-3",children:[(0,a.jsxs)("div",{className:"col-span-4",children:[a.jsx("div",{className:"text-sm font-medium text-neutral-900",children:e.name}),(0,a.jsxs)("div",{className:"mt-0.5 text-xs text-neutral-500",children:["Scopes: ",(e.scopes||["ingest"]).join(", ")]})]}),a.jsx("div",{className:"col-span-3",children:a.jsx("div",{className:"font-mono text-xs text-neutral-700",children:e.key_prefix||"-"})}),a.jsx("div",{className:"col-span-2",children:a.jsx("span",{className:d("inline-flex items-center rounded-full px-2 py-1 text-xs font-medium",t?"bg-emerald-50 text-emerald-700":"bg-neutral-100 text-neutral-600"),children:t?"Active":"Revoked"})}),a.jsx("div",{className:"col-span-2 text-xs text-neutral-600",children:function(e){if(!e)return"-";let t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()}(e.created_at)}),a.jsx("div",{className:"col-span-1 flex justify-end",children:t?a.jsx("button",{onClick:()=>void L(e.id),className:"rounded-lg border border-neutral-200 bg-white px-2.5 py-1.5 text-xs font-medium text-neutral-900 hover:bg-neutral-50",children:"Revoke"}):a.jsx("span",{className:"text-xs text-neutral-400",children:"-"})})]},e.id)})})]}),(0,a.jsxs)("div",{className:"mt-3 text-xs text-neutral-500",children:["Tip: use your key in SDK/CLI via ",a.jsx("span",{className:"font-mono",children:"X-API-Key"}),"."]})]})})]}),j&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:(0,a.jsxs)("div",{className:"w-full max-w-lg rounded-2xl bg-white shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-neutral-200 px-5 py-4",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-base font-semibold",children:"Create API Key"}),a.jsx("div",{className:"mt-0.5 text-xs text-neutral-500",children:"You'll see the raw key only once."})]}),a.jsx("button",{onClick:()=>y(!1),className:"rounded-lg p-2 text-neutral-500 hover:bg-neutral-100","aria-label":"Close",children:"✕"})]}),a.jsx("div",{className:"px-5 py-4",children:(0,a.jsxs)("div",{className:"grid gap-4",children:[(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs font-medium text-neutral-700",children:"Key name"}),a.jsx("input",{value:N,onChange:e=>k(e.target.value),placeholder:"e.g., ingest-prod",className:"mt-1 w-full rounded-xl border border-neutral-200 px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs font-medium text-neutral-700",children:"Project"}),a.jsx("select",{value:w,onChange:e=>P(e.target.value),className:"mt-1 w-full rounded-xl border border-neutral-200 bg-white px-3 py-2 text-sm outline-none focus:ring-2 focus:ring-black/10",disabled:o,children:o?a.jsx("option",{children:"Loading..."}):u.length?u.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id)):a.jsx("option",{value:"",children:"No projects found"})}),!o&&0===u.length&&(0,a.jsxs)("div",{className:"mt-2 text-xs text-neutral-500",children:["Create a project first in ",a.jsx("span",{className:"font-medium",children:"Projects"}),"."]})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"text-xs font-medium text-neutral-700",children:"Scopes"}),a.jsx("div",{className:"mt-2 grid grid-cols-1 gap-2 sm:grid-cols-3",children:I.map(e=>{let t=C.includes(e.id);return(0,a.jsxs)("button",{type:"button",onClick:()=>{_(s=>t?s.filter(t=>t!==e.id):[...s,e.id])},className:d("rounded-xl border px-3 py-2 text-left text-xs",t?"border-black bg-black text-white":"border-neutral-200 bg-white text-neutral-800 hover:bg-neutral-50"),children:[a.jsx("div",{className:"font-medium",children:e.id}),a.jsx("div",{className:d("mt-0.5",t?"text-white/80":"text-neutral-500"),children:e.label})]},e.id)})})]})]})}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-neutral-200 px-5 py-4",children:[a.jsx("button",{onClick:()=>y(!1),className:"rounded-xl border border-neutral-200 bg-white px-4 py-2 text-sm font-medium text-neutral-900 hover:bg-neutral-50",children:"Cancel"}),a.jsx("button",{onClick:()=>void G(),disabled:f||0===u.length,className:"rounded-xl bg-black px-4 py-2 text-sm font-medium text-white hover:opacity-90 disabled:opacity-50",children:f?"Creating...":"Create Key"})]})]})}),S&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40 px-4",children:(0,a.jsxs)("div",{className:"w-full max-w-lg rounded-2xl bg-white shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between border-b border-neutral-200 px-5 py-4",children:[(0,a.jsxs)("div",{children:[a.jsx("div",{className:"text-base font-semibold",children:"API Key Created"}),a.jsx("div",{className:"mt-0.5 text-xs text-neutral-500",children:"Copy and store it securely — it won't be shown again."})]}),a.jsx("button",{onClick:()=>A(null),className:"rounded-lg p-2 text-neutral-500 hover:bg-neutral-100","aria-label":"Close",children:"✕"})]}),a.jsx("div",{className:"px-5 py-4",children:a.jsx("div",{className:"rounded-xl border border-neutral-200 bg-neutral-50 p-3",children:a.jsx("div",{className:"break-all font-mono text-xs text-neutral-800",children:S})})}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2 border-t border-neutral-200 px-5 py-4",children:[a.jsx("button",{onClick:()=>{D(S)},className:"rounded-xl border border-neutral-200 bg-white px-4 py-2 text-sm font-medium text-neutral-900 hover:bg-neutral-50",children:"Copy"}),a.jsx("button",{onClick:()=>A(null),className:"rounded-xl bg-black px-4 py-2 text-sm font-medium text-white hover:opacity-90",children:"Done"})]})]})})]}):a.jsx("div",{className:"px-6 py-8",children:(0,a.jsxs)("div",{className:"max-w-3xl",children:[a.jsx("h1",{className:"text-2xl font-semibold tracking-tight",children:"API Keys"}),a.jsx("p",{className:"mt-2 text-sm text-neutral-500",children:"You need to be logged in to manage API keys."}),a.jsx("div",{className:"mt-6",children:a.jsx(r.default,{href:"/login",className:"inline-flex items-center rounded-xl bg-black px-4 py-2 text-sm font-medium text-white hover:opacity-90",children:"Go to Login"})})]})})}},89887:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>l,__esModule:()=>n,default:()=>i});var a=s(68570);let r=(0,a.createProxy)(String.raw`/app/frontend/app/api-keys/page.tsx`),{__esModule:n,$$typeof:l}=r;r.default;let i=(0,a.createProxy)(String.raw`/app/frontend/app/api-keys/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[687,618],()=>s(17297));module.exports=a})();